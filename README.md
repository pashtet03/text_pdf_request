# text_pdf_request
Работа с текстом из PDF: обработка, фильтрация, извлечение и суммаризация.

Подготовка: установка requirements.txt
Файлы: для запуска самеризации необходимо в папку Summary в корневой директории сложить файлы из модели https://huggingface.co/facebook/bart-large-cnn/tree/main.



Этот скрипт:

1. Извлекает текст из PDF.
2. Замазывает ненужные области (параметр замазки по умолчанию: 250).
3. Позволяет искать релевантные запросу предложения в тексте.
4. Создает краткое резюме на основе релевантных предложений.
5. Порог релевантности для поиска установлен на 0.15, а параметры саммари можно менять (длина текста).

Объяснение функций
1. create_folder(folder_name)
Назначение: Создает папку с указанным именем, если она не существует.
Зачем: Для сохранения промежуточных данных (например, изображений из PDF).
Описание строк:
1.1. Определяется текущая директория (os.getcwd()).
1.2. Проверяется существование папки (os.path.exists()).
1.3. Если папки нет, она создается (os.makedirs()).

2. process_page_with_borders(image)
Назначение: Замазывает области между широкими горизонтальными полосами.
Зачем: Для устранения ненужных элементов, таких как строки и разметки.
Описание строк:
2.1 Преобразует изображение в оттенки серого и применяет бинаризацию.
2.2. Находит контуры и фильтрует их по ширине и высоте.
2.3. Замазывает области между отобранными полосами, если расстояние меньше или равно 250.

3. pdf_to_images(pdf_path, output_folder)
Назначение: Конвертирует страницы PDF в изображения и обрабатывает их (замазывает).
Зачем: Чтобы подготовить изображения для OCR (распознавания текста).
Описание строк:
3.1. Конвертирует PDF в изображения (convert_from_path).
3.2. Проходит по всем страницам, замазывает их и сохраняет в указанной папке.

4. extract_text_from_images(input_folder, output_file)
Назначение: Извлекает текст с обработанных изображений.
Зачем: Для получения текста из PDF с помощью OCR.
Описание строк:
4.1. Инициализирует OCR-модуль EasyOCR для работы с русским и английским.
4.2. Читает текст из изображений и сохраняет его в текстовый файл.

5. remove_line_breaks(input_file, output_file)
Назначение: Удаляет лишние переносы строк.
Зачем: Для объединения текста в единый формат перед обработкой.
Описание строк:
5.1. Читает текст из файла, удаляет переносы строк (splitlines()), сохраняет результат.

6. generate_summary(input_file, output_file)
Назначение: Генерирует краткое содержание текста.
Зачем: Чтобы представить текст в упрощенной и понятной форме.
Описание строк:
6.1. Загружает модель и токенайзер BART из локальной директории.
6.2. Разделяет текст на части (не более 512 токенов).
6.3. Генерирует резюме для каждой части и объединяет их.
6.4. Параметры длины резюме (max_length, min_length) и прочие настройки модели позволяют управлять результатом.

8. extract_relevant_sentences(input_file, query, output_file, threshold)
Назначение: Находит предложения в тексте, релевантные запросу.
Зачем: Для выделения ключевых частей текста перед саммари.
Описание строк:
7.1. Загружает текст из файла и разбивает его на предложения с помощью SpaCy.
7.2. Преобразует предложения и запрос в векторы TF-IDF.
7.3. Вычисляет косинусное сходство между запросом (необходимо написать запрос в query) и каждым предложением.
7.4. Выбирает предложения, сходство которых выше порога (threshold).

9. Главный блок (if __name__ == "__main__":)
Описание шагов:
8.1. Создает папку для изображений PDF (create_folder).
8.2. Конвертирует PDF в изображения с замазыванием (pdf_to_images).
8.3. Извлекает текст из изображений (extract_text_from_images).
8.4. Удаляет лишние переносы строк из текста (remove_line_breaks).
8.5. Находит релевантные запросу предложения (extract_relevant_sentences).
8.6. Генерирует краткое содержание текста (generate_summary).
